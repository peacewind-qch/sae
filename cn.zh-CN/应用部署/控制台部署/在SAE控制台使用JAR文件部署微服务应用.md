# 在SAE控制台使用JAR文件部署微服务应用

本文以两个JAR文件为例介绍如何在SAE控制台部署微服务应用。

-   [创建命名空间](/cn.zh-CN/快速入门/准备工作.md)。
-   [创建VPC](/cn.zh-CN/快速入门/准备工作.md)。

本文以两个简单的示例JAR文件分别表示微服务的提供者和消费者。提供者提供简单的Echo服务，会返回消费者输入的消息。按照本文部署示例微服务应用后，您可以在浏览器中验证部署是否成功。

## 快速入门

## 部署提供者微服务应用

按照以下步骤将示例提供者微服务应用部署到SAE。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面单击**创建应用**。

3.  在**应用基本信息**页签，设置应用相关信息，配置完成后单击**下一步：应用部署配置**。

    ![Application_deployment_basic_information](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1369788951/p60491.png)

    参数说明如下表所示。

    |参数名|说明|
    |---|--|
    |应用名称|输入应用名称。允许数字、字母、下划线（\_）以及短划线（-）组合，仅允许字母开头，最大长度36个字符。|
    |专有网络配置|选择专有网络的配置方式。    -   **自定义配置**：选中后，您可以为创建的应用选择所需的命名空间、VPC、 VSwitch及安全组。
    -   **自动配置**：选中后，SAE将自动帮您配置命名空间、VPC、VSwitch及安全组，无需手动选择。 |
    |命名空间|在下拉菜单中选择创建好的命名空间。仅**自定义配置**专有网络时需要选择。**说明：** 命名空间和VPC是一一映射关系，如果需要修改VPC请单击**命名空间详情页**，在**命名空间详情**页面单击**切换VPC**修改VPC信息。 |
    |VSwitch|在下拉菜单中选择VSwitch。仅**自定义配置**专有网络时需要选择。VSwitch数量至少需要配置一个，建议不超过3个，且每个VSwitch至少匹配一个应用实例。 |
    |安全组|在下拉菜单中选择安全组。仅**自定义配置**专有网络时需要选择。**说明：** 如果您的VPC内没有创建安全组，请单击**创建安全组**，根据提示创建安全组，详细说明请参见[创建安全组](/cn.zh-CN/安全/安全组/创建安全组.md)。 |
    |应用实例数|选择需要创建的实例个数。|
    |VCPU|选择需要创建的实例CPU规格。|
    |内存|选择需要创建的实例内存规格。|
    |应用描述|填写应用的基本情况，输入的描述信息不超过100个字符。|

4.  在**应用部署配置**页签，选择**应用部署方式**为**JAR包部署**，依据页面指示进行配置，完成设置后单击**下一步：确认规格**。

    ![SAEJAR包方式部署](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/9353600061/p68758.png)

    参数说明如下表所示：

    |参数名|说明|
    |---|--|
    |应用运行环境|对于使用Spring Boot或Dubbo开发的应用，请选择**标准Java应用运行环境**；对于使用HSF开发的应用，请选择**EDAS-Container x.x.x**。本文的示例应用为Dubbo应用，因此选择**标准Java应用运行环境**。|
    |Java环境|选择以下的一个选项：    -   **openjdk-8u191-jdk-alpine3.9**
    -   **openjdk-7u201-jdk-alpine3.9**
    -   **Open JDK 8**
    -   **Open JDK 7** |
    |文件上传方式|可选择**上传JAR包**或者**JAR包地址**。    -   **上传JAR包**：单击**选择文件**，选择待部署的JAR文件。
    -   **JAR包地址**：输入JAR文件的存放地址。
**说明：** 应用部署程序包名称仅可包含字母、数字、中划线（-）和下划线（\_）。 |
    |版本|设置应用版本号，您可以选择输入版本号或者单击**使用时间戳为版本号**将时间戳作为应用版本号。|
    |时区设置|选择当前应用所在时区，例如**UTC+8**。|
    |高级配置|    -   **启动命令设置**（可选）：请参见[设置启动命令](/cn.zh-CN/应用部署/设置启动命令.md)。
    -   **环境变量设置**（可选）：请参见[设置环境变量](/cn.zh-CN/应用部署/设置环境变量.md)。
    -   **Hosts绑定设置**（可选）：请参见[设置Hosts绑定](/cn.zh-CN/应用部署/设置Hosts绑定.md)。
    -   **应用健康检查设置**（可选）：请参见[设置健康检查](/cn.zh-CN/应用部署/设置健康检查.md)。
    -   **应用生命周期管理设置**（可选）：请参见[设置应用生命周期管理](/cn.zh-CN/应用部署/设置PostStart和PreStop.md)。
    -   **日志收集设置**（可选）：请参见[设置日志收集](/cn.zh-CN/应用部署/设置日志收集.md)。
    -   **持久化存储**（可选）：请参见[设置NAS存储](/cn.zh-CN/应用部署/设置NAS存储.md)。
    -   **配置管理设置**（可选）：请参见[注入配置信息](/cn.zh-CN/应用部署/注入配置信息.md)。 |

5.  在**确认规格**页签，查看您所创建应用的详细信息以及费用配置情况，并单击**确认创建**。


## 部署消费者微服务应用

部署消费者微服务应用的步骤与部署提供者微服务的步骤相似，详细说明请参见[部署提供者微服务应用](#sc_deploy_provider)，在步骤四**JAR包地址**中输入示例消费者JAR文件的URL：

```
http://aliware-images.oss-cn-hangzhou.aliyuncs.com/demo/sae/spring-boot-consumer-1.0-SNAPSHOT.jar
```

## 验证部署是否成功

您可以通过提供者和消费者的服务列表页面判断部署是否成功。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面单击提供者应用的名称。

3.  在**基本信息**的页面的左侧导航栏单击**服务列表**，查看服务信息。

    如果**发布的服务**页签上可看到提供者所发布的服务，则说明提供者应用部署成功。

    ![查看发布服务-provider](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8269788951/p71180.png)

4.  返回**应用列表**页面并单击消费者应用的名称，在**基本信息**的页面的左侧导航栏单击**服务列表**，查看服务信息。

    如果**消费的服务**页签上可看到提供者所发布的服务，则说明消费者应用部署成功。

    ![查看发布服务-consumer](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8269788951/p71179.png)


## 验证微服务调用

您可以为消费者应用设置SLB公网访问，并在浏览器中发起调用请求来判断微服务调用是否能正常工作。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面单击消费者应用的名称。

3.  在**基本信息**页签的**应用访问设置**区域，单击**添加公网SLB访问**。

4.  在**添加公网SLB访问**对话框的**请选择SLB**下拉框中选择**新建**，并在**TCP协议**页签的**SLB端口**文本框输入80，在**容器端口**文本框输入9091，单击**确定**。

    **说明：**

    -   使用SLB会产生额外费用，SLB的计费方式
    -   文本框必须填写应用中设置的后端端口。本文示例应用的后端端口为9091。
    等待2分钟~3分钟后，SLB实例将绑定完毕，**公网访问地址**字段后将显示公网SLB访问地址及端口。

    ![pg_basic_info_sc_app_access_settings.png](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8269788951/p106208.png)

5.  在浏览器地址栏中输入以下URL。

    ```
    <公网SLB访问地址>:<端口>/sayHello/<自定义字符串>
    ```

    例如输入`http://*.***.169.144/sayHello/HelloSAE`。

    如果浏览器返回以下结果，则说明微服务调用成功。

    ```
    Hello, HelloSAE (from Spring Boot)
    ```


## 查看应用监控指标

应用成功部署后，您可以在**应用监控**模块中查看应用的关键性能指标。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面单击具体应用名称。

3.  在左侧导航栏按需查看应用监控数据：

    -   **应用总览**：选择**应用监控** \> **应用总览**，查看应用的关键性能指标，例如总请求量、平均响应时间等。
    -   **应用详情**：选择**应用监控** \> **应用详情**，查看更全面的应用监控数据，例如JVM监控、主机监控、异常分析等。
    -   **接口调用**：选择**应用监控** \> **接口调用**，查看以接口为维度的监控数据，例如调用拓扑图、链路上游、链路下游等。

## 更多信息

-   在SAE部署完成后，您可以对应用进行更新、扩缩容、启停、删除应用等生命周期管理操作，具体操作方式请参见[管理应用生命周期](/cn.zh-CN/应用管理/管理应用生命周期.md)。
-   在SAE部署完成后，您可以对应用进行自动弹性伸缩、SLB绑定和批量启停等提升应用性能的操作，具体操作方式请参见以下文档：
    -   [绑定SLB](/cn.zh-CN/应用管理/绑定SLB/为应用绑定SLB.md)
    -   [配置弹性伸缩策略](/cn.zh-CN/应用管理/配置弹性伸缩策略.md)
    -   [一键启停应用](/cn.zh-CN/应用管理/一键启停应用.md)
    -   [配置管理](/cn.zh-CN/应用管理/配置管理/配置管理概述.md)
    -   [变更实例规格](/cn.zh-CN/应用管理/变更实例规格.md)
-   在SAE部署完成后，您还可以对应用进行日志管理、监控管理、应用事件查看和变更记录查看等聚焦应用运行状态的操作，具体操作方式请参见以下文档：
    -   [日志管理](/cn.zh-CN/日志管理/查看实时日志.md)
    -   [监控管理](/cn.zh-CN/监控管理/基础监控.md)
    -   [应用事件查看](/cn.zh-CN/应用管理/查看应用事件.md)
    -   [变更记录查看](/cn.zh-CN/应用管理/查看变更记录.md)
    -   [使用Webshell诊断应用](/cn.zh-CN/应用管理/使用 Webshell 诊断应用.md)

## 问题反馈

如果您在使用SAE过程中有任何疑问，欢迎您扫描下面的二维码加入钉钉群进行反馈。

![SAE钉钉群2](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5885359951/p72048.png)

